<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Disneyland Paris Ultimate Quiz</title>
<style>
  :root{
    --bg1:#061321; --bg2:#000;
    --card:rgba(0,0,0,.82);
    --accent:#00bfff;
    --ok:#2ecc71; --bad:#e74c3c; --warn:#f39c12;
    --muted:#b9c6d6;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:flex; justify-content:center; align-items:center;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Trebuchet MS", sans-serif;
    color:#fff;
    background: radial-gradient(circle at 30% 20%, #0d2b4a, var(--bg1) 45%, var(--bg2) 100%);
  }
  #game{
    width:min(920px, 92vw);
    background: var(--card);
    border-radius: 22px;
    padding: 22px;
    box-shadow: 0 0 18px rgba(0,191,255,.35);
    border: 1px solid rgba(0,191,255,.18);
  }
  header{
    display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    margin-bottom: 10px;
  }
  h1{margin:0; font-size: clamp(20px, 2.6vw, 28px);}
  .sub{color:var(--muted); font-size: 13px;}
  .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between;}
  .pill{
    padding:8px 10px; border-radius:999px; background:rgba(0,191,255,.12);
    border:1px solid rgba(0,191,255,.25); color:#eaf8ff; font-size:13px;
  }
  .grid{
    display:grid; gap:12px;
    grid-template-columns: repeat(2, minmax(0,1fr));
  }
  @media (max-width: 720px){ .grid{grid-template-columns:1fr;} }
  button{
    width:100%;
    margin:0;
    padding:14px 14px;
    font-size: 15px;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    background: linear-gradient(45deg, #00bfff, #005bff);
    color: white;
    transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
  }
  button:hover{ transform: scale(1.02); box-shadow: 0 0 10px rgba(0,191,255,.45); }
  button:active{ transform: scale(.99); filter: brightness(.95); }
  .btn-ghost{
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.14);
    box-shadow:none;
  }
  .btn-warn{
    background: linear-gradient(45deg, #ffb100, #ff6a00);
  }
  .btn-bad{
    background: linear-gradient(45deg, #ff4b4b, #b700ff);
  }
  .panel{
    margin-top: 14px;
    padding: 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
  }
  .progress{
    height: 10px;
    background: rgba(255,255,255,.12);
    border-radius: 999px;
    overflow: hidden;
    margin: 12px 0 10px;
  }
  .bar{
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, rgba(0,191,255,.85), rgba(0,91,255,.95));
    transition: width .25s ease;
  }
  .q{
    font-size: 18px; line-height:1.25;
    margin: 10px 0 12px;
  }
  .meta{
    display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    color: var(--muted); font-size: 13px;
  }
  .answers{display:grid; gap:10px; margin-top: 12px;}
  .answers button{
    text-align:left;
    background: rgba(0,191,255,.10);
    border: 1px solid rgba(0,191,255,.22);
    box-shadow:none;
  }
  .answers button:hover{ box-shadow: 0 0 10px rgba(0,191,255,.25); }
  .correct{ background: rgba(46,204,113,.18) !important; border-color: rgba(46,204,113,.55) !important; }
  .wrong{ background: rgba(231,76,60,.18) !important; border-color: rgba(231,76,60,.55) !important; }
  .disabled{ pointer-events:none; opacity:.85; }
  .tag{
    padding:6px 10px; border-radius:999px; font-size:12px;
    background: rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.12);
    color:#fff;
  }
  .tag.easy{ border-color: rgba(46,204,113,.45); }
  .tag.medium{ border-color: rgba(0,191,255,.45); }
  .tag.hard{ border-color: rgba(243,156,18,.55); }
  .tag.extreme{ border-color: rgba(231,76,60,.55); }
  .two{
    display:grid; gap:12px;
    grid-template-columns: 1.25fr .75fr;
  }
  @media (max-width: 860px){ .two{grid-template-columns:1fr;} }
  input[type="number"]{
    width: 120px; padding:10px 12px; border-radius: 12px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.25);
    color:#fff;
    outline:none;
  }
  select{
    padding:10px 12px; border-radius: 12px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.25);
    color:#fff;
    outline:none;
  }
  .small{font-size:12px; color:var(--muted);}
</style>
</head>

<body>
  <div id="game">
    <header>
      <div>
        <h1>üé† Disneyland Paris ‚Äî Ultimate Quiz</h1>
        <div class="sub">Jeu cliquable multi-niveaux, questions al√©atoires, score & progression.</div>
      </div>
      <div class="row">
        <span class="pill" id="bankInfo">Banque: ‚Ä¶</span>
        <span class="pill" id="bestInfo">Meilleur score: ‚Äî</span>
      </div>
    </header>

    <div id="menu" class="panel">
      <div class="two">
        <div>
          <div class="row" style="margin-bottom:10px;">
            <div class="pill">üéØ Choisis ta difficult√©</div>
            <div class="pill">‚öôÔ∏è Options</div>
          </div>

          <div class="grid">
            <button onclick="startGame('easy')">üü¢ D√©butant</button>
            <button onclick="startGame('medium')">üîµ Interm√©diaire</button>
            <button class="btn-warn" onclick="startGame('hard')">üü† Expert</button>
            <button class="btn-bad" onclick="startGame('extreme')">üî¥ Ma√Ætre Disney</button>
          </div>

          <div style="margin-top:14px;" class="row">
            <label class="pill">Nombre de questions :
              <input id="qCount" type="number" min="5" max="50" value="15">
            </label>
            <label class="pill">Mode :
              <select id="mode">
                <option value="classic">Classique</option>
                <option value="streak">Combo (bonus s√©rie)</option>
                <option value="timed">Chrono (15s/question)</option>
              </select>
            </label>
          </div>
          <div class="small" style="margin-top:8px;">
            Astuce : tu peux monter √† 50 questions par partie (al√©atoires). Le jeu √©vite de r√©p√©ter la m√™me question dans une partie.
          </div>
        </div>

        <div>
          <div class="pill" style="margin-bottom:10px;">üìú R√®gles rapides</div>
          <div class="small" style="line-height:1.45;">
            ‚Ä¢ 4 r√©ponses, 1 seule bonne.<br>
            ‚Ä¢ Score + feedback instantan√©.<br>
            ‚Ä¢ Mode Combo : +1 bonus √† partir de 3 bonnes r√©ponses d‚Äôaffil√©e.<br>
            ‚Ä¢ Mode Chrono : 15s par question, sinon faux.<br>
            ‚Ä¢ Ton meilleur score par difficult√© est sauvegard√© dans le navigateur.
          </div>

          <div style="margin-top:12px;" class="row">
            <button class="btn-ghost" onclick="resetBests()">R√©initialiser meilleurs scores</button>
          </div>
        </div>
      </div>
    </div>

    <div id="quiz" class="panel" style="display:none;">
      <div class="meta">
        <div class="row" style="gap:8px;">
          <span id="difficultyTag" class="tag">‚Äî</span>
          <span class="pill" id="roundInfo">Question ‚Äî / ‚Äî</span>
          <span class="pill" id="timerInfo" style="display:none;">‚è±Ô∏è 15</span>
        </div>
        <div class="row" style="gap:8px;">
          <span class="pill" id="scoreInfo">Score: 0</span>
          <span class="pill" id="streakInfo" style="display:none;">Combo: 0</span>
          <button class="btn-ghost" style="width:auto; padding:10px 12px;" onclick="backToMenu()">Menu</button>
        </div>
      </div>

      <div class="progress"><div class="bar" id="bar"></div></div>
      <div class="q" id="question">‚Ä¶</div>
      <div class="answers" id="answers"></div>
      <div class="small" id="hint" style="margin-top:10px; opacity:.95;"></div>
    </div>

    <div id="end" class="panel" style="display:none;">
      <h2 style="margin:0 0 8px;">üéâ Fin de partie</h2>
      <div class="row" style="margin-bottom:10px;">
        <span class="pill" id="finalScore">Score: ‚Äî</span>
        <span class="pill" id="finalBest">Meilleur: ‚Äî</span>
      </div>
      <div class="grid">
        <button onclick="replay()">Rejouer m√™me difficult√©</button>
        <button class="btn-ghost" onclick="backToMenu()">Changer de difficult√©</button>
      </div>
      <div class="panel" style="margin-top:14px;">
        <div class="pill" style="margin-bottom:10px;">üìå Correction</div>
        <div id="review" class="small" style="line-height:1.5;"></div>
      </div>
    </div>
  </div>

<script>
/**
 * Banque de questions : 120 questions (30 par difficult√©).
 * Format:
 *  { q: "Question", a: ["A","B","C","D"], c: indexBonneR√©ponse, hint?: "Indice optionnel" }
 *
 * NOTE: Si tu veux ‚Äúencore plus‚Äù, dis-moi ‚Äúrajoute 300 questions‚Äù, et je t‚Äôen g√©n√®re d‚Äôun coup,
 * tri√©es par land (Main Street, Fantasyland, etc.) + un mode ‚ÄúPar th√®me‚Äù.
 */

const BANK = {
  easy: [
    {q:"Combien y a-t-il de parcs Disney √† Disneyland Paris ?", a:["1","2","3","4"], c:1},
    {q:"Quel personnage est le plus associ√© au logo Disney ?", a:["Mickey","Stitch","Woody","Ariel"], c:0},
    {q:"Quel est le nom du grand ch√¢teau au centre du Parc Disneyland ?", a:["Ch√¢teau de Cendrillon","Ch√¢teau de la Belle au Bois Dormant","Ch√¢teau de la Reine","Ch√¢teau d‚ÄôArendelle"], c:1},
    {q:"Dans quel land se trouve g√©n√©ralement le ch√¢teau ?", a:["Au centre du parc","Dans Frontierland","Dans Discoveryland","Dans Adventureland"], c:0},
    {q:"Quelle attraction est une balade en bateaux avec des pirates ?", a:["Pirates of the Caribbean","It's a Small World","Peter Pan","Dumbo"], c:0},
    {q:"Qui est le chien de Mickey ?", a:["Goofy","Pluto","Rex","Max"], c:1},
    {q:"Quel personnage est un canard ?", a:["Donald","Mickey","Simba","Olaf"], c:0},
    {q:"Quel personnage est un bonhomme de neige ?", a:["Olaf","Baymax","Wall-E","Timon"], c:0},
    {q:"Quel land est souvent associ√© aux contes de f√©es ?", a:["Fantasyland","Frontierland","Discoveryland","Adventureland"], c:0},
    {q:"Quelle zone correspond au Far West ?", a:["Frontierland","Fantasyland","Discoveryland","Main Street"], c:0},
    {q:"Quelle attraction est un ‚Äòpetit train‚Äô qui fait le tour du parc ?", a:["Disneyland Railroad","RC Racer","Casey Jr.","Orbitron"], c:0},
    {q:"Quel personnage est un lion ?", a:["Simba","Bambi","Dory","Baloo"], c:0},
    {q:"Quelle attraction est une croisi√®re autour d‚Äôun petit monde ?", a:["It's a Small World","Big Thunder Mountain","Star Tours","Indiana Jones"], c:0},
    {q:"Quel personnage est un jouet cow-boy ?", a:["Woody","Buzz","Sulley","Hercule"], c:0},
    {q:"Quel personnage est un ranger de l‚Äôespace jouet ?", a:["Buzz l‚Äô√âclair","Dingo","Aladdin","Merlin"], c:0},
    {q:"Quelle attraction te fait traverser le monde de Peter Pan ?", a:["Peter Pan‚Äôs Flight","Autopia","Phantom Manor","Ratatouille"], c:0},
    {q:"Quel v√©hicule est associ√© √† ‚ÄòAutopia‚Äô ?", a:["Des petites voitures","Des bateaux pirates","Des wagons de mine","Des navettes spatiales"], c:0},
    {q:"Quel personnage est une sir√®ne ?", a:["Ariel","Mulan","Tiana","Belle"], c:0},
    {q:"Quel personnage est une princesse qui porte une robe jaune (souvent) ?", a:["Belle","Elsa","Merida","Jasmine"], c:0},
    {q:"Dans quel land trouve-t-on souvent des aventures ‚Äòjungle / √Æles‚Äô ?", a:["Adventureland","Discoveryland","Fantasyland","Main Street"], c:0},
    {q:"Qui est l‚Äôami ‚Äòours‚Äô de Mowgli ?", a:["Baloo","Mushu","Olaf","Gaston"], c:0},
    {q:"Quel personnage est un extraterrestre bleu ?", a:["Stitch","Baymax","Wall-E","Pascal"], c:0},
    {q:"Quelle attraction est li√©e √† Blanche-Neige ?", a:["Snow White and the Seven Dwarfs","Indiana Jones","Star Tours","Cars Road Trip"], c:0},
    {q:"Que peut-on voir souvent le soir au-dessus du ch√¢teau ?", a:["Un spectacle nocturne","Un match de foot","Un feu de camp","Un concert de m√©tal"], c:0},
    {q:"Quelle attraction est souvent associ√©e √† des ‚Äò√©l√©phants volants‚Äô ?", a:["Dumbo","Pirates","Space Mountain","Tower of Terror"], c:0},
    {q:"Quel personnage est un robot gonflable blanc ?", a:["Baymax","Olaf","Groot","Genie"], c:0},
    {q:"Quel est le lieu ‚Äòentre‚Äô les deux parcs avec restos & boutiques ?", a:["Disney Village","Toontown","Gotham","Hogsmeade"], c:0},
    {q:"Main Street Vehicles appartient √† quel parc ?", a:["Aucun / hors du resort","Disney Village","Disney Adventure World (ex Walt Disney Studios)","Disneyland Park"], c:3},
    {q:"Toy Soldiers Parachute Drop appartient √† quel parc ?", a:["Disneyland Park","Disney Adventure World (ex Walt Disney Studios)","DisneySea","Disney Village"], c:1},
    {q:"Dans quel endroit du resort se trouve le restaurant Earl of Sandwich ?", a:["Disneyland Park","Disney Village","Disney Adventure World","Gare Marne-la-Vall√©e"], c:1},
    {q:"Cars ROAD TRIP appartient √† quelle zone d'Adventure World ?", a:["World of Frozen","World Premiere","World of Pixar","Avengers Campus"], c:2},
    {q:"Dans quel endroit du resort se trouve Pirate Galleon ?", a:["Disney Adventure World","Disney Village","Disneyland Park","Newport Bay Hotel"], c:2},
    {q:"Comment s‚Äôappelle le parc principal de Disneyland Paris ?", a:["Disney Adventure World","Disney Village","Disneyland Park","Magic Kingdom"], c:2},
    {q:"En quelle ann√©e Disneyland Paris a-t-il ouvert ?", a:["1955","2002","1992","1971"], c:2},
    {q:"Dans quel pays se situe Disneyland Paris ?", a:["Espagne","Italie","Maroc","France"], c:3},
    {q:"Qui est la mascotte de Disney ?", a:["Ed Euromaus","Mickey","Donald","Wonder Hook"], c:1},
    {q:"Quel est le nom de la parade (une parade connue actuelle) ?", a:["Electrical Parade","Disney Stars On Parade","Dreaming Up","Friendtastic Parade"], c:1},
    {q:"Quelle attraction permet de voler au-dessus de Londres ?", a:["Peter Pan‚Äôs Flight","Flight Force","Parachute Drop","Star Tours"], c:0},
    {q:"Quel est le nom du parc aquatique Disney en France ?", a:["Rulantica","Disney Splash","Il n'y en a pas","Blizzard Beach"], c:2},
    {q:"Quel est le nom d‚Äôun spectacle nocturne ?", a:["Illuminations","Happily Ever After","Tales of Magic","Fantasmic"], c:2},
    {q:"Quelle couleur domine le ch√¢teau de Disneyland Paris ?", a:["Rose","Bleu","Vert","Jaune"], c:0},
    {q:"Quelle attraction est une promenade en bateau √† Frontierland ?", a:["Mark Twain Riverboat","Thunder Mesa Riverboat Landing","Liberty Square Riverboat","Galion des pirates"], c:1},
    {q:"Quel restaurant est situ√© √† Main Street ?", a:["Casa de Coco","Casey Jr.","PYM Kitchen","Boardwalk Candy Palace"], c:3},
    {q:"Quel endroit permet de rencontrer les princesses Disney ?", a:["Le ch√¢teau","Training Center","Le Pavillon des Princesses","Panoramagique"], c:2},
    {q:"Quel lieu te teste pour devenir un Avenger ?", a:["W.E.B.","Crush‚Äôs Coaster","Training Center","Avengers Assemble: Flight Force"], c:2},
    {q:"Quel personnage peut √™tre rencontr√© surtout lors d‚Äô√©v√©nements Halloween/No√´l ?", a:["Gaston","Le P√®re No√´l","Jack Skellington","Mickey"], c:2},
  ],

  medium: [
    {q:"Quel h√¥tel est situ√© directement √† l‚Äôentr√©e du parc ?", a:["New York The Art of Marvel","Newport Bay Club","Sequoia Lodge","Disneyland Hotel"], c:3},
    {q:"Quel h√¥tel est sur le th√®me de Cars ?", a:["Disneyland Hotel","Newport Bay Club","Santa Fe","B&B Torcy"], c:2},
    {q:"Quel h√¥tel ne dispose pas de navette d√©di√©e (acc√®s surtout en voiture) ?", a:["Sequoia Lodge","Hotel Cheyenne","New York The Art Of Marvel","Davy Crockett Ranch"], c:3},
    {q:"Quel h√¥tel est sur le th√®me Far West ?", a:["Sequoia Lodge","Hotel Cheyenne","New York The Art Of Marvel","Davy Crockett Ranch"], c:1},
    {q:"Quelle attraction de Frontierland poss√®de une narration compl√®te li√©e √† Thunder Mesa ?", a:["Big Thunder Mountain","Thunder Mesa Riverboat","Phantom Manor","Le Lucky Nugget"], c:2},
    {q:"Quelle attraction utilise un syst√®me de v√©hicules suspendus √† Fantasyland ?", a:["Le Voyage de Pinocchio","Peter Pan's Flight","Dumbo the Flying Elephant","It's a Small World"], c:1},
    {q:"Quel restaurant de Disney Village propose une ambiance rock ?", a:["Sports Bar","Brasserie Rosalie","Earl of Sandwich","Rainforest Caf√©"], c:2},
    {q:"Comment s'appelle le th√©√¢tre de Frontierland ?", a:["The Chaparral Theater","Frontier Land Theater","Harambe Theater","Theater In The Wild"], c:0},
    {q:"Quel est le nom du lac reliant les h√¥tels, Disney Village et les parcs ?", a:["Adventure Bay","Lac Disney","Disney Village's Lake","Magical Lake"], c:1},
    {q:"Quelle zone de Disneyland Park est la plus v√©g√©talis√©e ?", a:["Discoveryland","Frontierland","Adventureland","Fantasyland"], c:2},
    {q:"Quel est le nom de la place centrale devant le ch√¢teau ?", a:["Castle Stage","Le Hub Central","Central Plaza","La cour du ch√¢teau"], c:2},
    {q:"Pourquoi Big Thunder Mountain est unique √† Paris ?", a:["Il poss√®de un looping","Il est en marche arri√®re","Il est sur une √Æle","Il n'y a pas de BTM √† Paris"], c:2},
    {q:"Quel land est directement reli√© √† Adventureland par des passages cach√©s ?", a:["Fantasyland","Main Street U.S.A.","Frontierland","Discoveryland"], c:2},
    {q:"Quel restaurant de Disneyland Park est r√©put√© pour son ambiance coloniale et ses buffets ?", a:["Colonel Hathi's Outpost","Plaza Gardens","Captain Jack's","Last Chance"], c:1},
    {q:"Quel type de musique est majoritairement diffus√© sur Main Street, U.S.A. ?", a:["Metal","Rap","Jazz","Country"], c:2},
    {q:"Quel √©l√©ment relie l'histoire de Big Thunder Mountain et Phantom Manor ?", a:["La famille Macron","La famille Ravenswood","La famille Disney","La famille Mack"], c:1},
    {q:"Quelle attraction d‚ÄôAdventureland est principalement explor√©e √† pied ?", a:["Adventure Isle","Pirates of the Caribbean","Le Passage Enchant√©","Disneyland Railroad"], c:0},
    {q:"Quelle attraction combine eau, d√©cors exotiques et narration ?", a:["Peter Pan's Flight","Pirates of the Caribbean","Hyperspace Mountain","DisneySea"], c:1},
    {q:"Quel est le principal objectif de Disney Village ?", a:["Manger","D√©penser encore plus","Prolonger l'exp√©rience Disney","Justifier le loyer du parc"], c:2},
    {q:"Quel land est inspir√© d‚Äôune vision ‚ÄòJules Verne‚Äô ?", a:["Discoveryland","Tomorrowland","Futureland","Starland"], c:0},
    {q:"Quel nom est historiquement associ√© au resort √† l‚Äôouverture ?", a:["Euro Disney / Euro Disneyland","Disney France","Paris Magic Resort","Disneyland Europe Park"], c:0},
    {q:"Quel √©l√©ment pr√©sent sur le ch√¢teau fait r√©f√©rence √† la France ?", a:["Sa couleur","Ses vitraux int√©rieurs","De petits escargots dor√©s","Le portrait du pr√©sident"], c:2},
  ],

  hard: [
    {q:"Quel √©l√©ment du ch√¢teau est unique √† Disneyland Paris et absent des autres parcs ?", a:["Le Dragon sous le ch√¢teau","Sa taille","Son spectacle","Son emplacement"], c:0},
    {q:"Dans quel land se trouve ‚ÄòSkull Rock‚Äô ?", a:["Adventureland","Frontierland","Fantasyland","Discoveryland"], c:0},
    {q:"‚ÄòLa Cabane des Robinson‚Äô est plut√¥t dans‚Ä¶", a:["Adventureland","Discoveryland","Fantasyland","Main Street"], c:0},
    {q:"Pourquoi Adventureland est-il volontairement labyrinthique √† Paris ?", a:["Pour renforcer l'immersion d'une exploration","Pour perdre des gens","Pour forcer √† passer devant les boutiques","Car les ing√©nieurs √©taient bourr√©s"], c:0},
    {q:"‚ÄòAdventure Isle‚Äô est‚Ä¶", a:["Un r√©seau de grottes & passerelles","Un grand huit","Un cin√©ma 3D","Un th√©√¢tre"], c:0},
    {q:"Quel est le type d‚Äôattraction d‚ÄôIndiana Jones (Paris) ?", a:["Montagnes russes","Bateau","Chute libre","Simulateur de vol"], c:0},
    {q:"Comment s'appelle le propri√©taire du manoir dans Thunder Mesa ?", a:["Henry Ravenswood","Billy Ravenswood","Patrick Ravenswood","M√©lanie Ravenswood"], c:0},
    {q:"Quelle attraction est une visite des ‚Äòcontes‚Äô en maquettes via bateaux ?", a:["Le Pays des Contes de F√©es","Pirates of the Caribbean","Ratatouille","Cars Road Trip"], c:0},
    {q:"Quel est l‚Äôint√©r√™t principal de ‚ÄòSwiss Family Treehouse‚Äô ?", a:["Explorer une maison dans un arbre","Un looping","Une chute aquatique","Un shooting"], c:0},
    {q:"Quel land contient ‚ÄòMain Street‚Äô ?", a:["C‚Äôest un land en soi","Fantasyland","Discoveryland","Aucun"], c:0},
    {q:"Quelle attraction est une ‚Äòmission spatiale‚Äô ?", a:["Space Mountain","Casey Jr.","Pirates","Dumbo"], c:0},
    {q:"‚ÄòLes Myst√®res du Nautilus‚Äô est une visite bas√©e sur‚Ä¶", a:["20 000 Lieues sous les mers","Voyage au centre de la terre","Le tour du monde en 80 jours","Star Wars"], c:0},
    {q:"Quel est le type de ‚ÄòStar Tours‚Äô ?", a:["Simulateur","Grand huit","Bateaux","Chute libre"], c:0},
    {q:"L‚Äôentr√©e du Parc Disneyland s‚Äôinspire surtout d‚Äôune‚Ä¶", a:["Rue am√©ricaine d√©but 1900","Ville futuriste","Jungle tropicale","Village m√©di√©val"], c:0},
    {q:"‚ÄòDiscovery Arcade‚Äô et ‚ÄòLiberty Arcade‚Äô sont‚Ä¶", a:["Deux passages couverts","Deux restaurants","Deux h√¥tels","Deux montagnes russes"], c:0},
    {q:"Quel est le principe d‚Äôun ‚Äòdark ride‚Äô ?", a:["Parcours en int√©rieur, sc√®nes anim√©es","Course de kart","Saut √† l‚Äô√©lastique","Jeu de ballon"], c:0},
  ],

  extreme: [
    {q:"Quel syst√®me technique in√©dit pr√©vu pour Space Mountain a √©t√© supprim√© avant l‚Äôouverture ?", a:["Un wagon suspendu","Des wagons avec rotations sur plusieurs axes","Des lunettes de r√©alit√© virtuelle","Des √©crans g√©ants"], c:1},
    {q:"Quel nom est tr√®s associ√© au resort √† l‚Äôouverture ?", a:["Disneyland Paris Resort","Disney France World","Paris Kingdom","Euro Disney Resort"], c:3},
    {q:"Le ch√¢teau parisien est d√©di√© √†‚Ä¶", a:["Cendrillon","Raiponce","La Belle au Bois Dormant","La Reine des Neiges"], c:2},
    {q:"‚ÄòSpace Mountain‚Äô √† Paris a eu un th√®me ‚ÄòDe la Terre √† la Lune‚Äô inspir√© de‚Ä¶", a:["Jules Verne","H.G. Wells","Tolkien","Asimov"], c:0},
    {q:"‚ÄòHyperspace Mountain‚Äô est li√© √† quel univers ?", a:["Marvel","Pixar","Frozen","Star Wars"], c:3},
    {q:"Quelle attraction est centr√©e sur une cuisine parisienne miniature ?", a:["Ratatouille","Cars Road Trip","Crush‚Äôs Coaster","Tower of Terror"], c:0},
    {q:"Quelle attraction pr√©vue n'est rest√©e qu'au stade de maquette ?", a:["Un dark ride Alice","Un dark ride La Belle et la B√™te", "Un dark ride Raiponce","Un dark ride Mickey"], c:1},
    {q:"Quelle attraction √©tait pr√©vue initialement √† la place de la Cabane des Robinson ?", a:['Un "flume" th√©matis√© Tarzan',"Un coaster Peter Pan","Un dark ride Livre de la Jungle","Un walkthrough Peter Pan"], c:0},
    {q:"Quelle superstar mondiale √©tait centrale dans Captain EO au Cin√©Magique ?", a:["Johnny Hallyday","Lady Diana","Bruce Willis","Michael Jackson"], c:3},
    {q:"Le ‚Äòdragon‚Äô sous le ch√¢teau est un √©l√©ment connu de‚Ä¶", a:["Disneyland Anaheim","Tokyo DisneySea","Disneyland Paris","Hong Kong Disneyland"], c:2, hint:"Sp√©cificit√© tr√®s c√©l√®bre de Paris"},
  ]
};


// --------- Etat du jeu ---------
let state = {
  level: null,
  mode: "classic",
  pool: [],
  round: [],
  idx: 0,
  score: 0,
  streak: 0,
  bonus: 0,
  qCount: 15,
  timer: null,
  timeLeft: 15,
  locked: false,
  history: [] // pour la correction
};

// --------- Helpers ---------
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

function keyBest(level){ return `dlp_best_${level}`; }
function getBest(level){
  const v = localStorage.getItem(keyBest(level));
  return v ? Number(v) : null;
}
function setBest(level, val){
  localStorage.setItem(keyBest(level), String(val));
}

function updateHeader(){
  const total = Object.values(BANK).reduce((s,arr)=>s+arr.length,0);
  document.getElementById("bankInfo").textContent = `Banque: ${total} questions`;
  const bests = ["easy","medium","hard","extreme"].map(l=>{
    const b = getBest(l);
    return `${l}:${b===null?"‚Äî":b}`;
  }).join("  ");
  document.getElementById("bestInfo").textContent = `Meilleurs scores: ${bests}`;
}

function tagLabel(level){
  if(level==="easy") return {text:"üü¢ D√©butant", cls:"easy"};
  if(level==="medium") return {text:"üîµ Interm√©diaire", cls:"medium"};
  if(level==="hard") return {text:"üü† Expert", cls:"hard"};
  return {text:"üî¥ Ma√Ætre Disney", cls:"extreme"};
}

// --------- UI ---------
function backToMenu(){
  stopTimer();
  document.getElementById("menu").style.display = "block";
  document.getElementById("quiz").style.display = "none";
  document.getElementById("end").style.display = "none";
  updateHeader();
}

function resetBests(){
  ["easy","medium","hard","extreme"].forEach(l => localStorage.removeItem(keyBest(l)));
  updateHeader();
}

function replay(){
  if(!state.level) return backToMenu();
  startGame(state.level);
}

function startGame(level){
  stopTimer();
  state.level = level;
  state.mode = document.getElementById("mode").value;
  state.qCount = clamp(Number(document.getElementById("qCount").value || 15), 5, 50);

  // Pool + tirage sans r√©p√©tition
  state.pool = shuffle(BANK[level]);
  state.round = state.pool.slice(0, Math.min(state.qCount, state.pool.length));
  state.idx = 0;
  state.score = 0;
  state.streak = 0;
  state.bonus = 0;
  state.locked = false;
  state.history = [];

  document.getElementById("menu").style.display = "none";
  document.getElementById("end").style.display = "none";
  document.getElementById("quiz").style.display = "block";

  // Tags / mode UI
  const t = tagLabel(level);
  const tag = document.getElementById("difficultyTag");
  tag.textContent = t.text;
  tag.className = `tag ${t.cls}`;

  document.getElementById("streakInfo").style.display = (state.mode==="streak") ? "inline-flex" : "none";
  document.getElementById("timerInfo").style.display  = (state.mode==="timed")  ? "inline-flex" : "none";

  showQuestion();
}

function showQuestion(){
  state.locked = false;
  const total = state.round.length;
  const current = state.round[state.idx];

  // Progress / header
  document.getElementById("roundInfo").textContent = `Question ${state.idx+1} / ${total}`;
  document.getElementById("scoreInfo").textContent = `Score: ${state.score}${state.mode==="streak" ? ` (+${state.bonus} bonus)` : ""}`;
  document.getElementById("streakInfo").textContent = `Combo: ${state.streak}`;
  document.getElementById("bar").style.width = `${(state.idx/total)*100}%`;

  document.getElementById("question").textContent = current.q;
  document.getElementById("hint").textContent = current.hint ? `üí° Indice : ${current.hint}` : "";

  const answers = document.getElementById("answers");
  answers.innerHTML = "";

  current.a.forEach((txt, i)=>{
    const b = document.createElement("button");
    b.textContent = `${"ABCD"[i]}. ${txt}`;
    b.onclick = ()=> pickAnswer(i, b);
    answers.appendChild(b);
  });

  // Timer
  if(state.mode==="timed"){
    state.timeLeft = 15;
    document.getElementById("timerInfo").textContent = `‚è±Ô∏è ${state.timeLeft}`;
    startTimer();
  } else {
    stopTimer();
  }
}

function startTimer(){
  stopTimer();
  state.timer = setInterval(()=>{
    state.timeLeft -= 1;
    document.getElementById("timerInfo").textContent = `‚è±Ô∏è ${state.timeLeft}`;
    if(state.timeLeft <= 0){
      stopTimer();
      // timeout = faux
      lockAnswers();
      revealAndNext(false, null, true);
    }
  }, 1000);
}
function stopTimer(){
  if(state.timer){ clearInterval(state.timer); state.timer = null; }
}

function lockAnswers(){
  const buttons = document.querySelectorAll("#answers button");
  buttons.forEach(b=> b.classList.add("disabled"));
  state.locked = true;
}

function pickAnswer(i, btn){
  if(state.locked) return;
  stopTimer();
  lockAnswers();

  const q = state.round[state.idx];
  const ok = (i === q.c);

  // Color feedback
  const buttons = document.querySelectorAll("#answers button");
  buttons[q.c].classList.add("correct");
  if(!ok) buttons[i].classList.add("wrong");

  revealAndNext(ok, i, false);
}

function revealAndNext(ok, chosenIndex, timeout){
  const q = state.round[state.idx];

  // Score system
  if(ok){
    state.score += 1;
    if(state.mode==="streak"){
      state.streak += 1;
      if(state.streak >= 3){
        state.bonus += 1;
        state.score += 1; // bonus point
      }
    }
  } else {
    if(state.mode==="streak") state.streak = 0;
  }

  state.history.push({
    q: q.q,
    a: q.a,
    correct: q.c,
    chosen: timeout ? null : chosenIndex,
    ok,
    timeout
  });

  // Update score display quickly
  document.getElementById("scoreInfo").textContent = `Score: ${state.score}${state.mode==="streak" ? ` (+${state.bonus} bonus)` : ""}`;
  document.getElementById("streakInfo").textContent = `Combo: ${state.streak}`;

  setTimeout(()=>{
    state.idx += 1;
    const total = state.round.length;
    document.getElementById("bar").style.width = `${(state.idx/total)*100}%`;

    if(state.idx >= total){
      endGame();
    } else {
      showQuestion();
    }
  }, 850);
}

function endGame(){
  stopTimer();
  document.getElementById("quiz").style.display = "none";
  document.getElementById("end").style.display = "block";

  const best = getBest(state.level);
  const improved = (best === null || state.score > best);
  if(improved) setBest(state.level, state.score);

  document.getElementById("finalScore").textContent = `Score: ${state.score} / ${state.round.length}`;
  document.getElementById("finalBest").textContent  = `Meilleur: ${getBest(state.level)} / ${state.round.length}`;

  // Correction
  const review = document.getElementById("review");
  review.innerHTML = state.history.map((h, idx)=>{
    const correctText = h.a[h.correct];
    const chosenText = (h.chosen === null)
      ? (h.timeout ? "‚è±Ô∏è Temps √©coul√©" : "‚Äî")
      : h.a[h.chosen];
    const icon = h.ok ? "‚úÖ" : "‚ùå";
    return `
      <div style="margin-bottom:10px;">
        <div><b>${idx+1}.</b> ${icon} ${escapeHtml(h.q)}</div>
        <div>‚û°Ô∏è Ta r√©ponse : <span style="color:${h.ok ? "var(--ok)" : "var(--bad)"}">${escapeHtml(chosenText)}</span></div>
        <div>‚úÖ Bonne r√©ponse : <span style="color:var(--ok)">${escapeHtml(correctText)}</span></div>
      </div>
    `;
  }).join("");

  updateHeader();
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, c => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
  }[c]));
}

// Init
updateHeader();
</script>
</body>
</html>


